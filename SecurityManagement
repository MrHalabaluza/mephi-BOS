#!/bin/bash
if [ "$(id -u)" != "0" ]
then
	echo "Для запуска необходимы права root" >&2
	exit
fi
echo 'Security Management

С помощью данной программы Вы можете управлять безопасностью файлов и каталогов

Разработали: Новиков, Галкина, Дудышева, Гарбуз, Рыбакова
'
if [ "$1" == "--help" ]&&[ $# == 1 ]
then
	echo "С помощью этой программы можно изменять права доступа к файлам и каталогам, изменять владельцов и группы, ACL права, а также найти файлы, доступные всем пользователям на запись

Если вы хотите работать с файлом, он может быть указан в виде аргумента либо введен в процессе выполнения программы"
else
	echo 'Главное меню:'
	options=("Работа с файлом" "Поиск файлов, доступных всем пользователям на запись" "Выход")
	select opt in "${options[@]}"
	do
		case "$REPLY" in
			1)
				f="true"
				if [ -a "$1" ]&&[ $# == 1 ]; 
				then
					path="$1"
				else
					echo "Файл не указан либо неверное количество аргументов" >&2
					echo "Введите путь до файла:"
					while [ "$f" == "true" ];
					do
						read -e path
						if [ -a "$path" ]
						then	
							f="false"	
						else
							echo "Указанный файл не существует" >&2
							echo "Повторите ввод:"
						fi
					done
				fi

				option=("Изменить права доступа" "Изменить владельца и группу" "Изменить ACL права" "Вернуться")
				select opt in "${option[@]}" 
				do
					case "$REPLY" in
						1)
							./change-mode.sh "$path"
							;;
						2)
							./OwnershipANDGroup.sh "$path"
							;;
						3)
							./ACL.sh "$path"
							;;
						4)	echo "1) Работа с файлом
2) Поиск файлов, доступных всем пользователям на запись
3) Выход"
							break
							;;
						"help")
							echo "В данном меню выберете, что вы хотите изменить
1) Изменить права доступа	3) Изменить ACL права
2) Изменить владельца и группу	4) Вернуться"
							;;
						*)
							echo "Неверный ввод" >&2
							;;
					esac
				done
				;;
			2)
				./FileSearch.sh
				;;
			3)
				echo "Good Bye"
				break
				;;
			"help")
				echo "В данном меню выберите основное действие
1) Работа с файлом
2) Поиск файлов, доступных всем пользователям на запись
3) Выход"
				;;
			*)
				echo "Неверный ввод" >&2
				;;
		esac
	done
fi
